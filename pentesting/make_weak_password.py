import requests
import base64
import json

packet = "srcIp=123&destIp=123&srcPort=5173"
requests.post(
    f"http://localhost:8080/api/auth/login?{packet}",
    json={"email": "john@gmail.com", "password": "john123"},
)
resp = requests.post(
    f"http://localhost:8080/api/auth/login?{packet}",
    json={"email": "john2@gmail.com", "password": "john123"},
)

jwt = resp.content.decode()

parts = jwt.split(".")
claims = json.loads(base64.b64decode(parts[1]))
print(claims)
print(f"nagPassword is checked: {claims['nagPassword']}")
