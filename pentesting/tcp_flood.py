import requests

K = 1000
TEN_PERCENT_OF_K = int(1000 * 0.1)

print(f"Logging in...")

packet = "srcIp=123&destIp=123&srcPort=5173"
resp = requests.post(
    f"http://localhost:8080/api/auth/login?{packet}",
    json={"email": "admin@sbnz.com", "password": "admin123"},
)
jwt = resp.content.decode()
header = {"Authorization": f"Bearer {jwt}"}

print(f"Submitting {K} GET requests to /api/test/any...")

for i in range(K):
    if i % TEN_PERCENT_OF_K == 0:
        print(f"[{i}/{K}]")
    requests.get(f"http://localhost:8080/api/test/any?{packet}", headers=header)
print(f"Finished attack")
